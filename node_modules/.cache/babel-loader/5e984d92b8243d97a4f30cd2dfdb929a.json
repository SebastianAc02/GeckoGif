{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback, useContext, useState } from \"react\";\nimport Context from \"../context/UserContext\";\nimport DeleteFavs from \"../services/deletefav\";\nimport FavService from \"../services/favService\";\nimport GetFavs from \"../services/getFavs\";\nimport LoginService from \"../services/loginService\";\nexport default function useUser() {\n  _s();\n\n  const {\n    jwt,\n    setjwt,\n    setfavs,\n    favs\n  } = useContext(Context);\n  const [state, setState] = useState({\n    loading: false,\n    error: false\n  });\n  const [isLoggedout, setIsLoggedout] = useState(false);\n  const login = useCallback(_ref => {\n    let {\n      username,\n      password\n    } = _ref;\n    setIsLoggedout(false);\n    setState({\n      loading: true,\n      error: false\n    });\n    LoginService({\n      username,\n      password\n    }).then(jwt => {\n      //  jwt = 'response'\n      setjwt(jwt);\n      window.sessionStorage.setItem('jwt', jwt);\n      setState({\n        loading: false,\n        error: false\n      });\n      setjwt(jwt);\n    }).catch(err => {\n      window.sessionStorage.removeItem('jwt');\n      setState({\n        loading: false,\n        error: true\n      });\n      console.log(err);\n    });\n  }, [setjwt]);\n  const addfav = useCallback(_ref2 => {\n    let {\n      id,\n      title,\n      url\n    } = _ref2;\n    FavService({\n      id,\n      jwt,\n      title,\n      url\n    }).then(ans => setfavs(prev => prev.concat(ans)));\n  }, [jwt, setfavs]);\n  const logout = useCallback(() => {\n    setIsLoggedout(true);\n    window.sessionStorage.removeItem('jwt');\n    setjwt(null);\n    setfavs([]);\n  }, [setjwt, setfavs]);\n  const deletefav = useCallback(_ref3 => {\n    let {\n      id\n    } = _ref3;\n    DeleteFavs({\n      id,\n      jwt\n    });\n    GetFavs({\n      jwt\n    }).then(ans => setfavs(ans.gifs));\n  }, [jwt, setfavs]);\n  return {\n    addfav,\n    favs,\n    isLogged: Boolean(jwt),\n    isLogingLoading: state.loading,\n    isLoadingError: state.error,\n    login,\n    logout,\n    state,\n    isLoggedout,\n    deletefav\n  };\n}\n\n_s(useUser, \"WvYzGJBkmCJiR7434P55CdIahPI=\");","map":{"version":3,"names":["useCallback","useContext","useState","Context","DeleteFavs","FavService","GetFavs","LoginService","useUser","jwt","setjwt","setfavs","favs","state","setState","loading","error","isLoggedout","setIsLoggedout","login","username","password","then","window","sessionStorage","setItem","catch","err","removeItem","console","log","addfav","id","title","url","ans","prev","concat","logout","deletefav","gifs","isLogged","Boolean","isLogingLoading","isLoadingError"],"sources":["/Users/sebastianacosta/Bootcamp/giffy/src/hooks/useUser.js"],"sourcesContent":["import { useCallback, useContext, useState } from \"react\";\nimport Context from \"../context/UserContext\";\nimport DeleteFavs from \"../services/deletefav\";\nimport FavService from \"../services/favService\";\nimport GetFavs from \"../services/getFavs\";\nimport LoginService from \"../services/loginService\";\n\nexport default function useUser(){\n\nconst {jwt, setjwt, setfavs, favs} = useContext(Context)\nconst [state,setState] = useState({loading:false, error: false});\n\nconst [isLoggedout, setIsLoggedout] = useState(false)\n\nconst login = useCallback(({username,password}) => {\n  setIsLoggedout(false)\n    setState({loading:true, error:false})\n  LoginService({username, password})\n  .then(jwt => {\n  //  jwt = 'response'\n  setjwt(jwt)\n  window.sessionStorage.setItem('jwt', jwt)\n    setState({loading:false, error :false})\n    setjwt(jwt)\n  })\n  .catch(err =>{\n    window.sessionStorage.removeItem('jwt')\n    setState({loading:false, error:true})\n   console.log(err)\n  })\n},[ setjwt])\n\nconst addfav = useCallback( ({id, title, url }) =>{\nFavService({id, jwt, title, url })\n.then(ans => setfavs((prev)=> prev.concat(ans)))\n\n},[jwt, setfavs])\n\nconst logout = useCallback(()=>{\n  setIsLoggedout(true)\n    window.sessionStorage.removeItem('jwt')\n    setjwt(null)\n    setfavs([])\n}, [setjwt, setfavs])\n\nconst deletefav = useCallback(({id}) =>{\nDeleteFavs({id, jwt})\n\nGetFavs({jwt})\n.then(ans => setfavs(ans.gifs))\n\n}, [jwt, setfavs])\n\n\n\nreturn{\n    addfav,\n    favs,\n    isLogged: Boolean(jwt),\n    isLogingLoading: state.loading,\n    isLoadingError: state.error,\n    login,\n    logout,\n    state,\n    isLoggedout,\n    deletefav\n\n}\n}"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,UAAtB,EAAkCC,QAAlC,QAAkD,OAAlD;AACA,OAAOC,OAAP,MAAoB,wBAApB;AACA,OAAOC,UAAP,MAAuB,uBAAvB;AACA,OAAOC,UAAP,MAAuB,wBAAvB;AACA,OAAOC,OAAP,MAAoB,qBAApB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AAEA,eAAe,SAASC,OAAT,GAAkB;EAAA;;EAEjC,MAAM;IAACC,GAAD;IAAMC,MAAN;IAAcC,OAAd;IAAuBC;EAAvB,IAA+BX,UAAU,CAACE,OAAD,CAA/C;EACA,MAAM,CAACU,KAAD,EAAOC,QAAP,IAAmBZ,QAAQ,CAAC;IAACa,OAAO,EAAC,KAAT;IAAgBC,KAAK,EAAE;EAAvB,CAAD,CAAjC;EAEA,MAAM,CAACC,WAAD,EAAcC,cAAd,IAAgChB,QAAQ,CAAC,KAAD,CAA9C;EAEA,MAAMiB,KAAK,GAAGnB,WAAW,CAAC,QAAyB;IAAA,IAAxB;MAACoB,QAAD;MAAUC;IAAV,CAAwB;IACjDH,cAAc,CAAC,KAAD,CAAd;IACEJ,QAAQ,CAAC;MAACC,OAAO,EAAC,IAAT;MAAeC,KAAK,EAAC;IAArB,CAAD,CAAR;IACFT,YAAY,CAAC;MAACa,QAAD;MAAWC;IAAX,CAAD,CAAZ,CACCC,IADD,CACMb,GAAG,IAAI;MACb;MACAC,MAAM,CAACD,GAAD,CAAN;MACAc,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,KAA9B,EAAqChB,GAArC;MACEK,QAAQ,CAAC;QAACC,OAAO,EAAC,KAAT;QAAgBC,KAAK,EAAE;MAAvB,CAAD,CAAR;MACAN,MAAM,CAACD,GAAD,CAAN;IACD,CAPD,EAQCiB,KARD,CAQOC,GAAG,IAAG;MACXJ,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,KAAjC;MACAd,QAAQ,CAAC;QAACC,OAAO,EAAC,KAAT;QAAgBC,KAAK,EAAC;MAAtB,CAAD,CAAR;MACDa,OAAO,CAACC,GAAR,CAAYH,GAAZ;IACA,CAZD;EAaD,CAhBwB,EAgBvB,CAAEjB,MAAF,CAhBuB,CAAzB;EAkBA,MAAMqB,MAAM,GAAG/B,WAAW,CAAE,SAAsB;IAAA,IAArB;MAACgC,EAAD;MAAKC,KAAL;MAAYC;IAAZ,CAAqB;IAClD7B,UAAU,CAAC;MAAC2B,EAAD;MAAKvB,GAAL;MAAUwB,KAAV;MAAiBC;IAAjB,CAAD,CAAV,CACCZ,IADD,CACMa,GAAG,IAAIxB,OAAO,CAAEyB,IAAD,IAASA,IAAI,CAACC,MAAL,CAAYF,GAAZ,CAAV,CADpB;EAGC,CAJyB,EAIxB,CAAC1B,GAAD,EAAME,OAAN,CAJwB,CAA1B;EAMA,MAAM2B,MAAM,GAAGtC,WAAW,CAAC,MAAI;IAC7BkB,cAAc,CAAC,IAAD,CAAd;IACEK,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,KAAjC;IACAlB,MAAM,CAAC,IAAD,CAAN;IACAC,OAAO,CAAC,EAAD,CAAP;EACH,CALyB,EAKvB,CAACD,MAAD,EAASC,OAAT,CALuB,CAA1B;EAOA,MAAM4B,SAAS,GAAGvC,WAAW,CAAC,SAAS;IAAA,IAAR;MAACgC;IAAD,CAAQ;IACvC5B,UAAU,CAAC;MAAC4B,EAAD;MAAKvB;IAAL,CAAD,CAAV;IAEAH,OAAO,CAAC;MAACG;IAAD,CAAD,CAAP,CACCa,IADD,CACMa,GAAG,IAAIxB,OAAO,CAACwB,GAAG,CAACK,IAAL,CADpB;EAGC,CAN4B,EAM1B,CAAC/B,GAAD,EAAME,OAAN,CAN0B,CAA7B;EAUA,OAAM;IACFoB,MADE;IAEFnB,IAFE;IAGF6B,QAAQ,EAAEC,OAAO,CAACjC,GAAD,CAHf;IAIFkC,eAAe,EAAE9B,KAAK,CAACE,OAJrB;IAKF6B,cAAc,EAAE/B,KAAK,CAACG,KALpB;IAMFG,KANE;IAOFmB,MAPE;IAQFzB,KARE;IASFI,WATE;IAUFsB;EAVE,CAAN;AAaC;;GA7DuB/B,O"},"metadata":{},"sourceType":"module"}