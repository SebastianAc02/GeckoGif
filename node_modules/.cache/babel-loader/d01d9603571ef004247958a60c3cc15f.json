{"ast":null,"code":"import _slicedToArray from\"/Users/sebastianacosta/Bootcamp/giffy/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useContext,useState}from\"react\";import Context from\"../context/UserContext\";import DeleteFavs from\"../services/deletefav\";import FavService from\"../services/favService\";import GetFavs from\"../services/getFavs\";import LoginService from\"../services/loginService\";export default function useUser(){var _useContext=useContext(Context),jwt=_useContext.jwt,setjwt=_useContext.setjwt,setfavs=_useContext.setfavs,favs=_useContext.favs;var _useState=useState({loading:false,error:false}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoggedout=_useState4[0],setIsLoggedout=_useState4[1];var login=useCallback(function(_ref){var username=_ref.username,password=_ref.password;setIsLoggedout(false);setState({loading:true,error:false});LoginService({username:username,password:password}).then(function(jwt){//  jwt = 'response'\nwindow.sessionStorage.setItem('jwt',jwt);setState({loading:false,error:false});//setjwt(jwt)\nsetjwt(window.sessionStorage.getItem('jwt'));}).catch(function(err){window.sessionStorage.removeItem('jwt');setState({loading:false,error:true});console.log(err);});},[setjwt]);var addfav=useCallback(function(_ref2){var id=_ref2.id,title=_ref2.title,url=_ref2.url;FavService({id:id,jwt:jwt,title:title,url:url}).then(function(ans){return setfavs(function(prev){return prev.concat(ans);});});},[jwt,setfavs]);var logout=useCallback(function(){setIsLoggedout(true);window.sessionStorage.removeItem('jwt');setjwt(null);setfavs([]);},[setjwt,setfavs]);var deletefav=useCallback(function(_ref3){var id=_ref3.id;DeleteFavs({id:id,jwt:jwt});GetFavs({jwt:jwt}).then(function(ans){return setfavs(ans.gifs);});},[jwt,setfavs]);return{addfav:addfav,favs:favs,isLogged:Boolean(jwt),isLogingLoading:state.loading,isLoadingError:state.error,login:login,logout:logout,state:state,setState:setState,isLoggedout:isLoggedout,deletefav:deletefav};}","map":{"version":3,"names":["useCallback","useContext","useState","Context","DeleteFavs","FavService","GetFavs","LoginService","useUser","jwt","setjwt","setfavs","favs","loading","error","state","setState","isLoggedout","setIsLoggedout","login","username","password","then","window","sessionStorage","setItem","getItem","catch","err","removeItem","console","log","addfav","id","title","url","ans","prev","concat","logout","deletefav","gifs","isLogged","Boolean","isLogingLoading","isLoadingError"],"sources":["/Users/sebastianacosta/Bootcamp/giffy/src/hooks/useUser.js"],"sourcesContent":["import { useCallback, useContext, useState } from \"react\";\nimport Context from \"../context/UserContext\";\nimport DeleteFavs from \"../services/deletefav\";\nimport FavService from \"../services/favService\";\nimport GetFavs from \"../services/getFavs\";\nimport LoginService from \"../services/loginService\";\n\nexport default function useUser(){\n\nconst {jwt, setjwt, setfavs, favs} = useContext(Context)\nconst [state,setState] = useState({loading:false, error: false});\n\nconst [isLoggedout, setIsLoggedout] = useState(false)\n\nconst login = useCallback(({username,password}) => {\n  setIsLoggedout(false)\n    setState({loading:true, error:false})\n  LoginService({username, password})\n  .then(jwt => {\n  //  jwt = 'response'\n\n  window.sessionStorage.setItem('jwt', jwt)\n    setState({loading:false, error :false})\n    //setjwt(jwt)\n    setjwt(window.sessionStorage.getItem('jwt'))\n  })\n  .catch(err =>{\n    window.sessionStorage.removeItem('jwt')\n    setState({loading:false, error:true})\n   console.log(err)\n  })\n},[ setjwt])\n\nconst addfav = useCallback( ({id, title, url }) =>{\n\nFavService({id, jwt, title, url })\n.then(ans => setfavs((prev)=> prev.concat(ans)))\n\n},[jwt, setfavs])\n\nconst logout = useCallback(()=>{\n  setIsLoggedout(true)\n    window.sessionStorage.removeItem('jwt')\n    setjwt(null)\n    setfavs([])\n}, [setjwt, setfavs])\n\nconst deletefav = useCallback(({id}) =>{\nDeleteFavs({id, jwt})\nGetFavs({jwt})\n.then(ans => setfavs(ans.gifs))\n\n}, [jwt, setfavs])\n\n\n\nreturn{\n    addfav,\n    favs,\n    isLogged: Boolean(jwt),\n    isLogingLoading: state.loading,\n    isLoadingError: state.error,\n    login,\n    logout,\n    state,\n    setState,\n    isLoggedout,\n    deletefav\n\n}\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}